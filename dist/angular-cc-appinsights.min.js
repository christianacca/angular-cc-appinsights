!function(){"use strict";angular.module("cc-appinsights",[])}(),function(){"use strict";function appInsightsProvider($provide,$httpProvider){function init(){provider.configOptions={},provider.defaultOptions={autoRun:!0,autoTrackExceptions:!0,autoTrackPageViews:!0,addPageViewCorrelationHeader:!1,ajaxTelemetryInitializers:[],pageViewTelemetryInitializers:["ccDefaultPageViewTelemetryInitializer"],telemetryInitializers:[]},provider.$get=["$injector",function($injector){return $injector.instantiate(AppInsights,{configOptions:provider.configOptions})}],provider.configure=configure}function configure(options){provider.configOptions=extend(provider.configOptions,provider.defaultOptions,options),provider.configOptions.autoTrackExceptions&&$provide.decorator("$exceptionHandler",decorateExceptionHandler),provider.configOptions.addPageViewCorrelationHeader&&$httpProvider.interceptors.push("ccAppInsightsHttpInterceptor")}function decorateExceptionHandler($delegate,$window){return function(exception,cause){if($delegate(exception,cause),$window.appInsights)try{$window.appInsights.trackException(exception)}catch(ex){$delegate(ex,"Application Insights")}}}function extend(target){for(var sources=[].slice.call(arguments,1),i=0;i<sources.length;i++){var source=sources[i]||{};for(var prop in source)source.hasOwnProperty(prop)&&(target[prop]=source[prop])}return target}var provider=this;init(),decorateExceptionHandler.$inject=["$delegate","$window"]}function AppInsights($rootScope,$location,$window,configOptions,$injector){function run(){!hasRun&&appInsights&&(hasRun=!0,addTelemetryInitializers(configOptions.pageViewTelemetryInitializers,isPageViewTelemetryItem),addTelemetryInitializers(configOptions.ajaxTelemetryInitializers,isAjaxTelemetryItem),addTelemetryInitializers(configOptions.telemetryInitializers),configOptions.autoTrackPageViews&&autoTrackPageViews())}function addTelemetryInitializers(initializers,condition){initializers&&initializers.forEach(function(initializer){"string"==typeof initializer&&(initializer=$injector.get(initializer));var ti=null!=condition?createConditionalTelemetryInitializer(initializer,condition):initializer;appInsights.context.addTelemetryInitializer(ti)})}function autoTrackPageViews(){$rootScope.$on("$routeChangeStart",trackNewPage),$rootScope.$on("$routeChangeSuccess",recordPageView),$rootScope.$on("$routeChangeError",function(){recordPageView(),appInsights.context.operation=previousOperation})}function createConditionalTelemetryInitializer(initializer,condition){return function(envelope){return condition(envelope)?initializer.apply(null,arguments):void 0}}function isPageViewTelemetryItem(envelope){return envelope.name===Microsoft.ApplicationInsights.Telemetry.PageView.envelopeType}function isAjaxTelemetryItem(envelope){return envelope.name===Microsoft.ApplicationInsights.Telemetry.RemoteDependencyData.envelopeType&&1===envelope.data.baseData.dependencyKind}function recordPageView(evt,route){null!=pageInProgress&&appInsights.stopTrackPage(pageInProgress.name,pageInProgress.url)}function trackNewPage(evt,route){if(!route||null!=route.redirectTo)return void(pageInProgress=null);pageInProgress={name:$location.path()||"/",url:$location.url()||"/"};var newOperation=new $window.Microsoft.ApplicationInsights.Context.Operation;newOperation.name=pageInProgress.name,previousOperation=appInsights.context.operation,appInsights.context.operation=newOperation,appInsights.startTrackPage(pageInProgress.name)}var previousOperation,pageInProgress,appInsights=$window.appInsights,hasRun=!1;this.configOptions=configOptions,this.service=appInsights,this.run=run}angular.module("cc-appinsights").provider("ccAppInsights",appInsightsProvider),appInsightsProvider.$inject=["$provide","$httpProvider"],AppInsights.$inject=["$rootScope","$location","$window","configOptions","$injector"]}(),function(){"use strict";function AppInsightsHttpInterceptor(appInsights){function init(){pageViewIdHeaderKey="ai-pv-opid","string"==typeof appInsights.configOptions.addPageViewCorrelationHeader&&(pageViewIdHeaderKey=appInsights.configOptions.addPageViewCorrelationHeader)}function addHeaders(config){return config.headers[pageViewIdHeaderKey]=impl.context.operation.id,config}var pageViewIdHeaderKey,impl=appInsights.service;init(),this.request=impl?addHeaders:angular.identity}angular.module("cc-appinsights").service("ccAppInsightsHttpInterceptor",AppInsightsHttpInterceptor),AppInsightsHttpInterceptor.$inject=["ccAppInsights"]}(),function(){"use strict";function defaultPageViewTelemetryInitializer($route){function parseControllerName(name){return null==name||-1===name.indexOf(" as")?name:name.split(" as")[0]}function setPageViewProperties(envelope){if($route.current){var pageView=envelope.data.baseData;pageView.properties=pageView.properties||{},pageView.properties.controller=parseControllerName($route.current.controller),pageView.properties.routePath=$route.current.originalPath||"/"}}return setPageViewProperties}angular.module("cc-appinsights").factory("ccDefaultPageViewTelemetryInitializer",defaultPageViewTelemetryInitializer),defaultPageViewTelemetryInitializer.$inject=["$route"]}(),function(){"use strict";function maybeAutoRun(appInsights){appInsights.configOptions.autoRun&&appInsights.run()}angular.module("cc-appinsights").run(maybeAutoRun),maybeAutoRun.$inject=["ccAppInsights"]}();
//# sourceMappingURL=dist/angular-cc-appinsights.min.js.map